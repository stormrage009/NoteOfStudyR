[["37-ggplot2.html", "第 6 章 ggplot2 6.1 几何形状 6.2 标度 6.3 主题设置", " 第 6 章 ggplot2 6.1 几何形状 df &lt;- read_csv(&quot;datas/datasaurus.csv&quot;) df ## # A tibble: 1,846 x 3 ## dataset x y ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 dino 55.4 97.2 ## 2 dino 51.5 96.0 ## 3 dino 46.2 94.5 ## 4 dino 42.8 91.4 ## 5 dino 40.8 88.3 ## 6 dino 38.7 84.9 ## 7 dino 35.6 79.9 ## 8 dino 33.1 77.6 ## 9 dino 29.0 74.5 ## 10 dino 26.2 71.4 ## # ... with 1,836 more rows # 计算数据中x和y的均值和方差，以及两者的相关系数 df %&gt;% group_by(dataset) %&gt;% summarise( across(everything(), list(mean = mean, sd = sd), .names = &quot;{fn}_{col}&quot;) ) %&gt;% mutate( across(where(is.numeric), round, 3) ) ## # A tibble: 13 x 5 ## dataset mean_x sd_x mean_y sd_y ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 away 54.3 16.8 47.8 26.9 ## 2 bullseye 54.3 16.8 47.8 26.9 ## 3 circle 54.3 16.8 47.8 26.9 ## 4 dino 54.3 16.8 47.8 26.9 ## 5 dots 54.3 16.8 47.8 26.9 ## 6 h_lines 54.3 16.8 47.8 26.9 ## 7 high_lines 54.3 16.8 47.8 26.9 ## 8 slant_down 54.3 16.8 47.8 26.9 ## 9 slant_up 54.3 16.8 47.8 26.9 ## 10 star 54.3 16.8 47.8 26.9 ## 11 v_lines 54.3 16.8 47.8 26.9 ## 12 wide_lines 54.3 16.8 47.8 26.9 ## 13 x_shape 54.3 16.8 47.8 26.9 以上数据的sd和mean值基本相同，是否可以断定每个数据集基本是一样的呢？ ggplot(df, aes(x, y)) + geom_point(aes(color = dataset)) + theme_bw() + theme(legend.position = &quot;NONE&quot;) + facet_wrap(~dataset) 事实上，每张图都相差很大。所以，这里想说明的是，眼见为实。换句话说，可视化是数据探索中非常重要的部分。本章的目的就是带领大家学习ggplot2基本的绘图技能。 6.1.1 图形部件 一张统计图形就是从数据到几何形状(geometric object，缩写geom)所包含的图形属性(aesthetic attribute，缩写aes)的一种映射。 data: 数据框data.frame (注意，不支持向量vector和列表list类型） aes: 数据框中的数据变量映射到图形属性。什么叫图形属性？就是图中点的位置、形状，大小，颜色等眼睛能看到的东西。什么叫映射？就是一种对应关系，比如数学中的函数b = f(a)就是a和b之间的一种映射关系, a的值决定或者控制了b的值，在ggplot2语法里，a就是我们输入的数据变量，b就是图形属性， 这些图形属性包括： x（x轴方向的位置） y（y轴方向的位置） color（点或者线等元素的颜色） size（点或者线等元素的大小） shape（点或者线等元素的形状） alpha（点或者线等元素的透明度） geoms: 几何形状，确定我们想画什么样的图，一个geom_***确定一种形状。更多几何形状推荐阅读这里 geom_bar() geom_density() geom_freqpoly() geom_histogram() geom_violin() geom_boxplot() geom_col() geom_point() geom_smooth() geom_tile() geom_density2d() geom_bin2d() geom_hex() geom_count() geom_text() geom_sf() stats: 统计变换 scales: 标度 coord: 坐标系统 facet: 分面 layer： 增加图层 theme: 主题风格 save: 保存图片 图 6.1: ggplot2语法 图 6.2: ggplot2图层语法框架 6.2 标度 ggplot2中的scales语法，可以阅读《ggplot2: Elegant Graphics for Data Analysis》，但如果需要详细了解标度参数体系，还是要看ggplot2官方文档。 简单来说，标度是用于调整数据映射的图形属性。 6.2.1 丰富的标度体系 标度函数是由”_“分割的三个部分构成的： scale 视觉属性名 (e.g., colour, shape or x) 标度名 (e.g., continuous, discrete, brewer). 图 6.3: ggplot2标度函数一览 每个标度函数内部都有丰富的参数系统： scale_colour_manual( palette = function(), limits = NULL, name = waiver(), labels = waiver(), breaks = waiver(), minor_breaks = waiver(), values = waiver(), ... ) 参数name，坐标和图例的名字，如果不想要图例的名字，就可以 name = NULL。 参数limits, 坐标或图例的范围区间。连续性c(n, m)，离散型c(\"a\", \"b\", \"c\")。 参数breaks, 控制显示在坐标轴或者图例上的值（元素）。 参数labels, 坐标和图例的间隔标签。 一般情况下，内置函数会自动完成 也可人工指定一个字符型向量，与breaks提供的字符型向量一一对应 也可以是函数，把breaks提供的字符型向量当做函数的输入 NULL，就是去掉标签 参数values 指的是（颜色、形状等）视觉属性值, 要么，与数值的顺序一致； 要么，与breaks提供的字符型向量长度一致 要么，用命名向量c(\"数据标签\" = \"视觉属性\")提供 参数expand, 控制参数溢出量 参数range, 设置尺寸大小范围，比如针对点的相对大小 6.3 主题设置 theme(element_name = element_function())函数中的element_function参数有四个： element_text()：文本，用于控制标签和标题的字体风格。 element_lint()：线条，用于控制线条/线段的颜色或类型 element_rect()：矩形区域，用于控制背景矩形颜色或边界线条类型。 element_blank()：空白，就是不分配相应的绘图空间，即删去这个地方的绘图元素。 这部分我们着重来看。 df &lt;- mpg %&gt;% as_tibble() %&gt;% filter(class != &quot;2seater&quot;, manufacturer %in% c(&quot;toyota&quot;, &quot;volkswagen&quot;)) df ## # A tibble: 61 x 11 ## manufacturer model displ year cyl trans drv cty hwy fl ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; ## 1 toyota 4run~ 2.7 1999 4 manu~ 4 15 20 r ## 2 toyota 4run~ 2.7 1999 4 auto~ 4 16 20 r ## 3 toyota 4run~ 3.4 1999 6 auto~ 4 15 19 r ## 4 toyota 4run~ 3.4 1999 6 manu~ 4 15 17 r ## 5 toyota 4run~ 4 2008 6 auto~ 4 16 20 r ## 6 toyota 4run~ 4.7 2008 8 auto~ 4 14 17 r ## 7 toyota camry 2.2 1999 4 manu~ f 21 29 r ## 8 toyota camry 2.2 1999 4 auto~ f 21 27 r ## 9 toyota camry 2.4 2008 4 manu~ f 21 31 r ## 10 toyota camry 2.4 2008 4 auto~ f 21 31 r ## # ... with 51 more rows, and 1 more variable: class &lt;chr&gt; # 基础图形 ggplot(df, aes(x = displ, y = hwy, color = factor(cyl))) + geom_point() + facet_grid(vars(manufacturer), vars(class)) + ggtitle(&quot;This is my title&quot;) + labs(x = &quot;x_displ&quot;, y = &quot;y_hwy&quot;) 6.3.1 图形的整体元素 图形的整体元素包括： 整个图形的背景： 描述 主题元素 类型 整个图形背景 plot.background element_rect() 图形标题 plot.title element_text() 图形边距 plot.margin margin() "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
